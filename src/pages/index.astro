---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = await getCollection("blog", ({ data }) => !data.draft);
const recentPosts = posts
  .sort((a, b) => b.data.publishedAt.valueOf() - a.data.publishedAt.valueOf())
  .slice(0, 3);
---

<BaseLayout
  title="Adrien Brault"
  description="Principal-level engineer who ships products across the stack. Technical writing on LLMs, Python, React/TS, system design, and home automation."
>
  <section class="py-8">
    <h1 class="text-4xl font-bold mb-4">Hey, I'm Adrien</h1>
    <p class="text-xl text-[var(--color-text-muted)] mb-6 max-w-2xl">
      Principal-level engineer who ships products across the stack, thriving in
      the age of AI-assisted development. I value breadth, architectural
      judgment, and product thinking.
    </p>
    <p class="text-lg mb-8 max-w-2xl">
      I write about LLMs, Python, TypeScript/React, system design, and my
      hobbies: 3D printing, photography, and home automation.
    </p>
    <div class="flex gap-4">
      <a
        href="/about"
        class="inline-block px-4 py-2 bg-[var(--color-accent)] text-white rounded-md hover:opacity-90 transition-opacity"
      >
        About me
      </a>
      <a
        href="/blog"
        class="inline-block px-4 py-2 border border-[var(--color-border)] rounded-md hover:border-[var(--color-accent)] transition-colors"
      >
        Read the blog
      </a>
    </div>
  </section>

  {
    recentPosts.length > 0 && (
      <section class="py-8 border-t border-[var(--color-border)]">
        <h2 class="text-2xl font-semibold mb-6">Recent Posts</h2>
        <ul class="space-y-4">
          {recentPosts.map((post) => (
            <li>
              <a
                href={`/blog/${post.id}`}
                class="group block p-4 -mx-4 rounded-lg hover:bg-[var(--color-border)]/50 transition-colors"
              >
                <h3 class="text-lg font-medium group-hover:text-[var(--color-accent)]">
                  {post.data.title}
                </h3>
                <p class="text-[var(--color-text-muted)] mt-1">
                  {post.data.description}
                </p>
                <time
                  datetime={post.data.publishedAt.toISOString()}
                  class="text-sm text-[var(--color-text-muted)] mt-2 block"
                >
                  {post.data.publishedAt.toLocaleDateString("en-US", {
                    year: "numeric",
                    month: "long",
                    day: "numeric",
                  })}
                </time>
              </a>
            </li>
          ))}
        </ul>
        <a
          href="/blog"
          class="inline-block mt-6 text-[var(--color-accent)] hover:underline"
        >
          View all posts &rarr;
        </a>
      </section>
    )
  }
</BaseLayout>
