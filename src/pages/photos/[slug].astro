---
import BaseLayout from "../../layouts/BaseLayout.astro";
import PhotoGrid from "../../components/PhotoGrid.astro";
import { photoCollections, getCollection } from "../../lib/photos";

export function getStaticPaths() {
  return photoCollections.map((collection) => ({
    params: { slug: collection.slug },
  }));
}

const { slug } = Astro.params;
const collection = getCollection(slug);

if (!collection) {
  return Astro.redirect("/404");
}
---

<BaseLayout
  title={collection.title}
  description={collection.description ?? `Photo collection: ${collection.title}`}
>
  <nav class="mb-6">
    <a
      href="/photos"
      class="text-[var(--color-text-muted)] hover:text-[var(--color-accent)]"
    >
      &larr; All Photos
    </a>
  </nav>

  <header class="mb-8">
    <h1 class="text-4xl font-bold mb-2">{collection.title}</h1>
    <div class="flex items-center gap-2 text-[var(--color-text-muted)]">
      <span>{collection.date}</span>
      {collection.location && (
        <>
          <span>&middot;</span>
          <span>{collection.location}</span>
        </>
      )}
      <span>&middot;</span>
      <span>{collection.photos.length} photos</span>
    </div>
    {collection.description && (
      <p class="mt-4 text-lg">{collection.description}</p>
    )}
  </header>

  <PhotoGrid collectionSlug={collection.slug} photos={collection.photos} />
</BaseLayout>
