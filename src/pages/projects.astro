---
import BaseLayout from "../layouts/BaseLayout.astro";
import ProjectCard from "../components/ProjectCard.astro";
import { getCollection } from "astro:content";

const projects = await getCollection("projects");
const sortedProjects = projects.sort((a, b) => {
  // Featured projects first, then by year (newest first)
  if (a.data.featured !== b.data.featured) {
    return a.data.featured ? -1 : 1;
  }
  return (b.data.year ?? 0) - (a.data.year ?? 0);
});
---

<BaseLayout
  title="Projects"
  description="A curated selection of projects I've worked on, from LLM tooling to open source contributions."
>
  <h1 class="text-4xl font-bold mb-4">Projects</h1>
  <p class="text-lg text-[var(--color-text-muted)] mb-8">
    A curated selection of projects I've worked on.
  </p>

  {
    sortedProjects.length === 0 ? (
      <p class="text-[var(--color-text-muted)]">Projects coming soon!</p>
    ) : (
      <ul class="grid gap-6">
        {sortedProjects.map((project) => (
          <li>
            <ProjectCard
              title={project.data.title}
              description={project.data.description}
              url={project.data.url}
              repo={project.data.repo}
              tags={project.data.tags}
              featured={project.data.featured}
              year={project.data.year}
              status={project.data.status}
            />
          </li>
        ))}
      </ul>
    )
  }
</BaseLayout>
